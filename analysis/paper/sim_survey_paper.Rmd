---
title: Using simulation to optimize the sampling design of fisheries-independent trawl surveys
author: "Paul M. Regular, Fran Mowbray, et al.?"
date: "Fisheries and Oceans Canada, Northwest Atlantic Fisheries Center, 80 East White Hills, St. John's, Newfoundland and Labrador, A1C 5X1, Canada"
output: 
  bookdown::word_document2:
    reference_docx: template.docx
bibliography: references.bib
csl: ices-journal-of-marine-science.csl
---

```{r setup, include=FALSE}

# devtools::install_github("rstudio/rmarkdown@v1.10")

knitr::opts_chunk$set(echo = FALSE,
                      message = FALSE,
                      warning = FALSE,
                      dev = "png",
                      dpi = 300)
knitr::opts_knit$set(root.dir = "../..")
```


```{r data, include = FALSE}
library(SimSurvey)
library(plotly)
library(raster)
library(lattice)
library(viridis)
library(data.table)
load("analysis/cod_sim_exports/2018-09-17_age_clust_test/test_output.RData")
```


```{r fun}

## http://www.moeding.net/archives/32-Metric-prefixes-for-ggplot2-scales.html
format_si <- function(...) {
  # Format a vector of numeric values according
  # to the International System of Units.
  # http://en.wikipedia.org/wiki/SI_prefix
  #
  # Based on code by Ben Tupper
  # https://stat.ethz.ch/pipermail/r-help/2012-January/299804.html
  # Args:
  #   ...: Args passed to format()
  #
  # Returns:
  #   A function to format a vector of strings using
  #   SI prefix notation
  #
  
  function(x) {
    limits <- c(1e-24, 1e-21, 1e-18, 1e-15, 1e-12,
                1e-9,  1e-6,  1e-3,  1e0,   1e3,
                1e6,   1e9,   1e12,  1e15,  1e18,
                1e21,  1e24)
    prefix <- c("y",   "z",   "a",   "f",   "p",
                "n",   "µ",   "m",   " ",   "k",
                "M",   "G",   "T",   "P",   "E",
                "Z",   "Y")
  
    # Vector with array indices according to position in intervals
    i <- findInterval(abs(x), limits)
  
    # Set prefix to " " for very small values < 1e-24
    i <- ifelse(i == 0, which(limits == 1e0), i)

    paste0(format(round(x/limits[i], 1),
                 trim = TRUE, scientific = FALSE, ...),
          prefix[i])
  }
}
si <- format_si()

## little helper function for the fan plot
fan_plot <- function(d, x = "Age", which_strat = "Age") {
  
  if (which_strat == "Total") {
    ints_by = c("year", "set_den")
  }
  if (which_strat == "Age") {
    ints_by = c("year", "age", "set_den", "lengths_cap")
  }
  if (which_strat == "Length") {
    ints_by = c("year", "length", "set_den", "lengths_cap")
  }
  
  ## quantiles for fan plot
  quants <- seq(90, 10, by = -10)
  ints <- lapply(quants, function(q) {
    d[, list(prob = paste0(q, "%"),
             lower = quantile(I_hat, prob = (1 - q / 100) / 2),
             upper = quantile(I_hat, prob = 1 - (1 - q / 100) / 2)), 
      by = ints_by]
  })
  ints <- rbindlist(ints)
  ints$prob <- factor(ints$prob, levels = paste0(quants, "%"))
  
  true <- d[d$sim %in% 1:3, ]
  
  if (x == "Age") {
    p <- ggplot(data = ints, aes(x = age))
    xlabs <- c("2", "4", "6", "8", "10+")
    xbreaks <- seq(2, 10, 2)
  }
  if (x == "Length") {
    p <- ggplot(data = ints, aes(x = length))
    xbreaks <- xlabs <- seq(0, 100, 20)
    xlabs[xlabs == 100] <- "100+"
  }
  if (x == "Year") {
    p <- ggplot(data = ints, aes(x = year))
    xlabs <- waiver()
    xbreaks <- waiver()
  }
  
  p <-  p + 
    geom_ribbon(aes(ymin = lower, ymax = upper, fill = prob, alpha = prob)) +
    geom_line(aes(y = I), data = true, color = "black", size = 0.6) +
    scale_fill_viridis(name = "Pr", discrete = TRUE, begin = 0.1) +
    scale_alpha_discrete(name = "Pr", range = c(0.5, 1)) + 
    xlab(x) + ylab("Abundance index") +
    scale_y_continuous(labels = format_si()) +
    scale_x_continuous(expand = c(0.01, 0), 
                       labels = xlabs, 
                       breaks = xbreaks) +
    guides(color = guide_legend(keywidth = 0.4, keyheight = 0.25, 
                                default.unit = "cm", ncol = 1))
  
  if (which_strat == "Total") {
    p <- p + facet_wrap(~ set_den, nrow = 1,
                        labeller = label_bquote(cols = D[sets]==.(set_den)))
  } else {
    p <- p + facet_grid(lengths_cap ~ set_den, 
                        labeller = label_bquote(cols = D[sets]==.(set_den),
                                                rows = M[lengths]==.(lengths_cap)))
  }
  
  p + theme_bw() +
    theme(legend.justification = c(0, 1),
          plot.margin = unit(c(0.2, 0.2, 0.2, 0.2), "cm"),
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          strip.background = element_blank(),
          panel.border = element_rect(fill = NA, color = "darkgrey", size = 0.4),
          axis.ticks = element_line(color = "darkgrey", size = 0.4))
  
}


```



# Abstract

A central question to fish stock assessments is: how many samples are needed to adequately represent the population being monitored? For assessments based on trawl surveys, our ability to estimate population characteristics, such as abundance at age, is affected by multiple levels of sampling (i.e. the number of sets, lengths and ages sampled in a survey). We therefore need to assess the impact of haul design and length and age sampling on survey accuracy to determine optimal sampling effort. In this study we simulated repeated stratified-random samples from a spatially correlated field of simulated fish. These samples were then analyzed and estimates of abundance at age were compared against a known truth. By varying the sampling protocol, we demonstrate that increasing the number of sets conducted per stratum provides the greatest gains in precision when sampling a clustered population. Increasing length and age sampling efforts also improved abundance estimates, but to a lesser extent and improvements were typically marginal, and sometimes squandered, when sub-sampling effort was increased. These results indicate that high levels of length and age sampling effort can be scaled back without significant losses to precision and, in some cases, estimates of abundance at age may be improved by reducing sub-sampling effort. Time saved by reducing said sampling may afford more time to conduct additional sets and/or increase sampling efforts of other species. While this simulation is tailored to a specific case, the method may be adapted to different systems and survey procedures.

**Keywords** - length and age distribution; simulation; spatial correlation; stratified analysis; survey design

# Introduction

Fisheries-independent trawl surveys have become an increasingly important research tool for the management of dynamic fish stocks. These surveys provide reliable indices of population abundance as well as estimates of various population characteristics such as length and age frequencies [@Pennington1998]. While costly to obtain, this information forms the basis of of many stock assessments models used throughout the world. Effective and informed management decisions therefore require surveys that maximize information while minimizing the expense of data collection. Determining the number of samples required to adequately characterize a fish population is particularly challenging since data tend to be collected across one or more stages [@Aanes2015]. Optimal survey design is further complicated by the fact that trawls sample clusters of fish that tend to have similar characteristics, such as length, age and stomach contents. This phenomenon results in samples with positive intra-haul correlation, which can markedly reduce the effective sample size for estimating length and age frequencies of the target population [@Pennington1994; @Pennington2002; @Stewart2014]. The complexities of multi-stage sampling and intra-haul correlation make it difficult to answer the question *"how much sampling is enough?"*  

Two main approaches have been applied to try and answer this question: one involves statistical estimators of effective sample size [@Pennington2002; @Stewart2014], and the other employs resampling methods to test alternate sampling protocol [@Cervino2006; @Zhang2013]. Both approaches have shown that lengths are usually oversampled and a reduction in said sampling can often be done without significant loss of accuracy [@Pennington2002]. The same result holds for other positively correlated characteristics, such as age [@Coggins2013] and stomach contents [@Bogstad1995]. Pennington and Vølstad [-@Pennington1994] concluded that the best way to improve the accuracy of surveys with strong intra-haul correlation is to take fewer samples per sampling unit and increase the total number of sampling locations. Few studies, however, have tested these conclusions using simulations. Simulations are a useful approach for informing the design of surveys [@sutherland2006] and they have been used widely for exploring the number of samples needed to obtain estimates with reasonable precision [e.g. distance sampling surveys; @thomas2010]. A key advantage of a pure simulation approach is that "true" population size and all stages of sampling can be controlled (set, length and age sampling protocol). The relative effects of each stage of sampling on our perception of the "truth" can then be tested. This level of testing is of particular importance for age composition estimates, and the contemporary age-based assessment models that rely on these estimates, as they are affected by all stages of sampling. A key challenge, of course, is building a simulation that emulates reality.  

The objective of this paper is to use a realistic simulation to evaluate the efficacy of various sampling protocol. First we simulated a spatially autocorrelated target population, and then we simulated surveys over this field. Set density was varied across surveys, as was length and age sampling efforts. Estimates of abundance at age were then obtained using a standard stratified approach [@Smith1981] and deviation from the truth was assessed. Given previous findings, we predict that the greatest gains in precision will come from increasing the number of hauls; increased sampling of correlated variables (length and age) on a set by set basis will be relatively ineffective. The bottom trawl survey of cod (*Gadus morhua*) in NAFO division 3Ps, Newfoundland, was used as a case study for this analysis. While our case study is specific, we also hope that the approach presented here will provide a framework for optimizing sampling protocol for an array of species with different life-histories and distributions. To facilitate future work and collaborations, we have developed an R package for conducting the tests presented in this paper (https://github.com/PaulRegular/SimSurvey).

# Methods

## Simulate abundance

The simulation presented here starts with a common cohort model where the abundance at age $a$ in year $y$ ($N_{a,y}$) equals the abundance of that cohort in the previous year multiplied by the survival rate, which is expressed in terms of total mortality ($Z_{a,y}$):

$$N_{a,y} = N_{a-1,y-1} e^{-Z_{a-1,y-1}}$$
Here, numbers at age in the first year are filled via exponential decay, $N_{a,1} = N_{a-1,1} e^{-Z_{a-1,1}}$, numbers at age 1 (i.e. recruits) vary around a baseline value, $log(N_{1,y}) = log(\mu_r) + \epsilon_{y}$, and total mortality is set to a baseline level plus process error, $log(Z_{a,y}) = log(\mu_Z) + \delta_{a,y}$. The error around the recruitment process was set to follow a random walk, $\epsilon_{y} \sim N(\epsilon_{y - 1}, \sigma_{r}^{2})$, and the process error was simulated using the covariance structure described in Cadigan [-@Cadigan2016], $\delta_{a,y} \sim N(0, \Sigma_{a,y})$. The covariance across ages and years is controlled by a process error variance parameter ($\sigma_{\delta}^2$) along with age and year correlation parameters ($\varphi_{\delta, age}$ and $\varphi_{\delta, year}$, respectively). This structure allows for autocorrelation in process errors across ages and years (i.e. total mortality can be made to be more similar for fish that are closer together in age and time). Abundance at age is then converted to abundance at length using the original von Bertalanffy growth curve [@Cailliet2006]:

$$log(l) = log(l_{\infty} - (l_{\infty} - l_0) e^{-Ka}) + \varepsilon$$

Where $l_{\infty}$ is the mean asymptotic length, $l_0$ is length at birth, $K$ is the growth rate parameter and the error is assumed to follow the normal distribution, $\varepsilon \sim N(0, \sigma_{l}^2)$. Abundance in discrete length groups, $l_{group}^{N}$, was determined by using this formula to calculate the probability of being within a specific length group given age and then using the resultant length-age-key to convert abundance at age to abundance at length. Overall, this  formulation allows for the simulation of an array of population dynamics that one might expect to observe.

## Simulate spatial distribution

The next step in the simulation is to distribute the abundance at age matrix simulated using the cohort model throughout a spatial field. Here, a grid of $s$ locations was generated with a resolution of $R$ and a depth gradient. The depth gradient was set-up to have a sigmoid shape with a depth range of $[d_{min}, d_{max}]$, shelf depth of $d_{shelf}$ and a shelf width of $w_{shelf}$. The simulated population is distributed through the grid by simulating spatial-temporal noise controlled by a parabolic relationship with depth and covariance between ages, years and space

$$\begin{aligned}log(N_{a,y,s}) &= log(N_{a,y}) + \eta_{a,y,s} \\ \eta_{a,y,s} &= \frac{(d_s - \mu_{d}) ^ 2}{2 \sigma_d^2} + \xi_{a,y,s} \end{aligned}$$

Where $d_s$ is the depth in a specific cell of the grid, $\mu_d$ is the mean depth where abundance is typically highest and $\sigma_d$ controls the width or dispersion of abundance around the mean. This helps simulate depth preferences of particular fish. Residual noise $\xi_{a,y,s}$ is added to this depth relationship using a combination of Matérn covariance, to control the level of spatial aggregation, and the age-year covariance described in Cadigan [-@Cadigan2016], to control the level of similarity in distributions across ages and years. Spatial correlations was controlled by a smoothing ($\lambda$) and scaling parameter ($\kappa$) [here we approximate $\kappa$ from a range parameter ($r$), $\kappa = \sqrt{8 \lambda} / r$; @Blangiardo2015] and correlation across ages and years was controlled by $\varphi_{\xi, age}$ and $\varphi_{\xi, year}$, respectively. The overall variance of the process was controlled by $\sigma_{\xi}^2$. In short, this formulation allows control of depth preferences, the level of spatial aggregation and the amount of age and year specific clustering. Note that $\eta_{a,y,s}$ is forced to sum to one in each year to ensure that the total population of each age for each year through the grid equals the number simulated by the cohort model. Also note that numbers were rounded such that a discrete number of fish are in each cell of the grid. A more detailed description of the space-age-year covariance is included in Appendix 1. Note that the the distributions of specific length groups were not simulated because of the greater computational cost of storing spatially dis-aggregated abundance across all length groups.

## Simulate survey

The final step in the simulation is to conduct a stratified random survey over the age-year-space array generated using formula described above. First, the grid is divided into $N_{div}$ divisions and $N_{strat}$ depth-based strata. The area of each strata is calculated and this is used to define the sets to allocate to each strata under a particular set density, $D_{sets}$. The allocated number of cells are randomly selected in each strata and the number of fish caught in each set is calculated by applying binomial sampling of the fish in each sampled cell by the proportion of the area covered by the trawl and the catchability of each age:

$$n_{a,y,s} \sim Bin(N_{a,y,s}, \frac{A_{trawl}}{A_{cell}} q_a )$$
Where $n_{a,y,s}$ is the number of fish sampled by a set, $A_{trawl}$ indicates the area covered by the trawl, $A_{cell}$ is the area of a grid cell (i.e. $R^2$), and $q_a$ is the catchability coefficient of each age. Here, catchabilities were defined using a logistic curve controlled by a steepness, $k$, and midpoint parameter, $x_0$. The lengths of the fish sampled by the set are then simulated using the von Bertalanffy growth equation found above in the [Simulate abundance] section. Depending on the number of fish caught, sub-sampling is then conducted. Specifically, a maximum number of lengths are measured per set, $M_{lengths}$, and a maximum number of ages, $M_{ages}$, are sampled per length group, $l_{group}$, per division.

## Assumptions

Like any model, this simulation is a simplification of a much more complex reality. For instance, the population is assumed to aggregate by age-class and be uniformly distributed within a cell when, in the real-world, they may aggregate by length and form finer-scale clusters. The survey is also an instantaneous snapshot of the population, meaning that the population is assumed to be in the same location from the beginning to the end of the survey. Also, fish are aged at random within length bins and ages are estimated without error. Finally, area trawled is assumed to be perfectly standard. This is a short, non-inclusive, list of additional variability that likely occurs in the real-world but was not implemented here for simplicity.

## Simulation settings and analysis

Ideally the parameter settings used here would be based on model fits to real data, however, conditioning the operating model described above was outside the scope of this project. Moreover, many of the parameters described above may not be identifiable or it may be difficult to obtain un-biased estimates [e.g. bias introduced by length-stratified sampling complicate the fitting of growth models; @Morgan1997]. As such, parameters were informally selected to roughly correspond to observations typically obtained by the Fisheries and Oceans Canada survey of cod in NAFO division 3Ps, Newfoundland. Though this approach is far from exact, the goal was to approximate the life-history and distribution of an actual population to simulate an arena for testing the consequences of surveys with different sampling protocol. Parameter settings and descriptions used in this case study are presented in Table \@ref(tab:par). A series of `r nrow(sim$surveys)` surveys were tested using an array of different sampling protocol outlined in Table \@ref(tab:tests). Each survey was simulated `r max(sim$age_strat_error$sim)` times over the same population and samples were run through a stratified analysis [@Smith1981] to obtain annual estimates of total abundance ($\hat{I}_{y,k}$), abundance at length ($\hat{I}_{l,y,k}$) and abundance at age ($\hat{I}_{a,y,k}$). We used root-mean-squared error (RMSE) as a measure of the precision and bias of the abundance at age estimates from each survey:

$$RMSE = \sqrt{\frac{ \sum_{a = 1}^{N_a} \sum_{y = 1}^{N_y} \sum_{k = 1}^{N_k} (\hat{I}_{a,y,k} - I_{a,y})^2}{N_a N_y N_k}}$$
Where $N_a$, $N_y$, and $N_k$ are the number of years, ages and simulations, respectively, and $I_{a,y}$ is the true abundance available to the survey (i.e. catchability corrected abundance; $I_{a,y} = q_a N_{a,y}$). RMSE was also calculated for abundance at length estimates. Intra-haul correlation (i.e. intraclass correlation) of set catch was also calculated by fitting a mixed-model to the lengths data with set as a random effect [fit using the lme4 package; @Bates2015]; variance estimates from this model were then plugged into the ICC(1) formula presented in McGraw and Wong [-@Mcgraw1996]. All simulations and analyses were conducted using `r substr(version$version.string, 1, 15)` [@R2017] and the code has been developed into a package called `SimSurvey` to facilitate future work and collaboration (https://github.com/PaulRegular/SimSurvey).

# Results

```{r icc, cache = TRUE}
len_samp <- merge(sim$setdet, sim$samp, by = "set")
len_samp <- len_samp[len_samp$sim == 1 & len_samp$measured, ]
sim_icc <- round(icc(len_samp$length, len_samp$set), 1)
sim_icc <- sprintf("%.2f", sim_icc)
real_icc <- "0.70" # calculated in the file "imatate_cod_data.R"
```


A dynamic population that varies across ages, time and space was simulated with the parameter settings used here (Table \@ref(tab:par)). Figure \@ref(fig:sp) depicts the aggregate distribution of the population in one year of the simulation and the corresponding catches of one stratified random survey over this population. Layered within this, of course, is the distributions of each age, as well as age and length sampling details. Though age-specific details are not depicted for simplicity, the general pattern of spatial aggregation apparent in Figure \@ref(fig:sp) is similar across all ages. That is, all ages tend to aggregate in fairly dense clusters and low-density zones are fairly wide ranging. The survey, therefore, tends to be characterized by regions with large catches interspersed with regions of no catch (Figure \@ref(fig:sp)). The samples within each successful set are also dynamic and rarely include all age groups. This is because only moderate correlation was imposed on the distributions of ages 1-5+, allowing individuals of different ages to occupy different locations. This results in an intra-haul correlation of approximately `r sim_icc`, which, in this case, is of equal magnitude to the intra-haul correlation observed across more than 20 years of survey data of 3Ps cod.

The stratified analyses run on these simulated data provided estimates of total abundance, abundance at length and abundance at age, and different stages of sampling affect these estimates. Specifically, set density affects all estimates, length sampling affects estimates of abundance at length and abundance at age, and age sampling affects abundance at age estimates. Figure \@ref(fig:tot) depicts the consequences of different set densities on the estimates of total abundance available to the survey through the simulated series. It is clear from this figure that the probability envelopes are tighter (i.e. estimates are more precise) and bias is negligible. Likewise, abundance at length and abundance at age estimates are more precise as set density is increased (Figure \@ref(fig:length), \@ref(fig:age), \@ref(fig:year)). With the exception of a length sampling protocol of 10 measurements per set ($M_{lengths}$ = 10), there appears to be little difference in the estimates of abundance at length when the number of measurements are capped at 100 ($M_{lengths}$ = 100) or 1000 ($M_{lengths}$ = 1000; Figure \@ref(fig:length)). Some downward bias is apparent in the abundance at length estimates, especially at larger lengths, under the low to medium set density scenarios with low length sampling effort ($D_{sets}$ = 0.0005 or 0.002 and $M_{lengths}$ = 10; Figure \@ref(fig:length)). Upward or downward bias in abundance at age estimates is apparent in all cases except the high set density and high length sampling scenario ($D_{sets}$ = 0.01 and $M_{lengths}$ = 1000; Figure \@ref(fig:age), \@ref(fig:year)). Under both low and medium set densities ($D_{sets}$ = 0.0005 and 0.02, respectively), increasing length sampling effort from 10 or 100 measurements per set to 1000 appears to increase bias or reduce precision slightly (Figure \@ref(fig:age), \@ref(fig:year)).

For a less visual approach to assessing precision and bias, RMSE results are presented in Figures \@ref(fig:error-lines) and \@ref(fig:error-wireframe) and Table \@ref(tab:comp). Figure \@ref(fig:error-lines) depicts the effects of set density and length sampling effort on abundance at length and abundance at age estimates. In all cases, increases in set density results in large declines in RMSE (Figure \@ref(fig:error-lines)). For abundance at length estimates, RMSE declines as the number of lengths measured increases, however, gains plateau beyond a cretin point. Likewise, RMSE of abundance at age estimates decline with increased length sampling effort, but RMSE does not plateau in all set density scenarios (Figure \@ref(fig:error-lines)). While RMSE continues to decline with increased length sampling effort under the high set density scenarios ($D_{sets}$ = 0.005 to 0.01 sets / km^2^), RMSE reaches a plateau and then increases with increased length sampling effort under the medium to low set density scenarios ($D_{sets}$ = 0.002 to 0.0005 sets / km^2^; Figure \@ref(fig:error-lines)). In many cases, RMSE for both metrics is lower for scenarios with higher set density but lower length sampling effort (Figure \@ref(fig:error-lines)). Similar patterns are apparent in Figure \@ref(fig:error-wireframe) and Table \@ref(tab:comp), which focus on the consequences of set density and length and age sampling protocol on the estimates of abundance at age. Again, RMSE clearly declines with increases to set density and sometimes declines with increased length sampling effort (Figure \@ref(fig:error-wireframe)). Under both low and medium set density scenarios ($D_{sets}$ = 0.005 to 0.01 sets / km^2^), measuring a maximum of 100 fish per set appears to be better than measuring a maximum of 1000 fish per set (Figure \@ref(fig:error-wireframe); Table \@ref(tab:comp)). Decreasing the age sampling protocol below 10 ages sampled per set per length group appears to result in relatively small increases to RMSE (Figure \@ref(fig:error-wireframe); Table \@ref(tab:comp)).


# Discussion

The simple simulation presented here revealed some expected and unexpected patterns. First, there were clear improvements to precision in all population estimates as the number of sets were increased. This result was expected as it aligns with a basic principle of survey design that the precision and representativeness of a survey increases as the number of sampling units are increased [@sutherland2006]. Second, stratified estimates of abundance at age were often biased and, in some cases, estimates were poorer when sub-sampling effort was increased. This result was unexpected because design-based estimators, such as the stratified analysis applied here, are expected to be unbiased [@smith1990] and increases to sub-sampling effort was expected to be relatively ineffective, not detrimental. Results from stratified estimates of abundance at length, in contrast, better align with these expectations. By deduction, these results indicate that the issue stems from the intervening age-length key and not the design-based estimator.

Using an age-length key in conjunction with the length distribution to estimate abundance at age is standard procedure in the analysis of fisheries-independent survey data as only a small fraction of the catch is typically aged. This is because the aging procedure is costly and time-consuming whereas length measurements are relatively easy to obtain. Ages are generally determined from length-stratified sub-samples of the catch and raw proportions of age-at-length are used to assign ages to fish in specific length groups. Age-length keys are usually constructed at larger spatial scales because there are rarely enough samples to stratify these data. Here we construct one age-length key for the division, as is done for the analysis of 3Ps cod. There is, however, a potential cost to the spatial scale of the key. Namely, it is unlikely that one age-length key is representative for the whole region because the probability of being a specific age given length varies in space [@Berg2012]. This would not be an issue if there was no size (age) specific clustering, however, this may not always be the case because different size groups often occur in different places because of ontogenetic habitat shifts [@dahlgren2000; @galaiduk2017]. For instance, it is not uncommon for populations to form distinct nursery and spawning areas [@marteinsdottir2000; @booth2000]. Because different age groups sometimes occur in different places, the translation of lengths to ages may be biased by the samples used to generate the age-length key. This bias is perhaps compounded by the length-stratified sampling of ages such that the ages sampled may be skewed towards sets with the most catch, especially under scenarios where length sampling effort is high. If this is the case, then the representativeness of the age-length key to the whole population could be diminished by excessive length sampling. 

The negative consequences of excessive length sampling on abundance at age estimates are most apparent under the low set density scenarios. The precision of the estimates are also the poorest when fewer sets are conducted. Sets, however, are the most costly sample to obtain and, as such, the set densities of fisheries-independent surveys tend to be on the lower end of the scenarios presented in this paper. The set density of the multi-species survey conducted by Fisheries and Oceans Canada in the Newfoundland region, for instance, ranges between 0.001 and 0.002 sets / km^2^. Length sampling effort, in contrast, tends to be on the higher end of the scenarios presented here because lengths are relatively cheap and easy to obtain. Again, using Fisheries and Oceans Canada sampling protocol from the Newfoundland region as an example, it is not uncommon for length sampling effort to be capped at 500 measurements per set. The results presented in this paper paradoxically suggest that better abundance at age estimates are obtained by lowering the length sampling cap. Results also indicate that reductions to length sampling effort would not significantly impact abundance at length estimates. Nonetheless, it is hard to be prescriptive because this simulation is far from a perfect reflection of reality and it focuses on one case study. Further research is required on the consequences of some of the assumptions of this simulation as well as the interaction between age-specific clustering, length-stratified sampling and the age-length key. Ideally, the simulation would also include multiple species with different life-histories and distributions, and also integrate a cost component to assess the trade-offs between information and cost. Finally, it would be interesting to test alternate analyses of these data that may account for the spatial structure of the age-length key [e.g. @Berg2012].

While much work has yet to be done, results from the simple simulation echo the growing body of literature which concludes that extra sub-sampling is an ineffective means of improving estimates relative to sampling more locations [@Pennington1994; @Pennington2002; @Stewart2014; @Bogstad1995; @Coggins2013; @Zhang2013]. In general, the most significant source of variation in fisheries-independent surveys stems from set-to-set variation, and not variability from individual sub-samples. This is largely because fish caught together tend to be more similar than those in the general population [@Pennington1994]. Therefore, if the goal of a trawl survey is to maximize information, it is likely better to stop collecting psudoreplicates and, instead, focus efforts on other species or the next set.

# Acknowledgements

- Feedback and advice: Aaron Adamack, Alejandro Buren, Noel Cadigan, Karen Dwyer, Geoff Evans, Brian Healey, Paul Higdon, Danny Ings, Mariano Koen-Alonso, Joanne Morgan, Keith Lewis, Derek Osborne, Pierre Pepin, Dwayne Pittman, Don Power, Greg Robertson, Martha Robertson, Mark Simpson, Brad Squires, Don Stansbury, Peter Upward
- Dave Cote for a review of a previous version of this manuscript
- NSERC visiting-fellow program


# Tables

Table: (\#tab:par) - Parameter descriptions, symbols and global settings used in the cod case study.

|                                       **Parameter name** |                 **Symbol** |    **Setting** |
|:-------------------------------------------------------- | :------------------------- | :------------- |
|                                              *Abundance* |                            |                |  
|                                                     Ages |                        $a$ |           1:20 |
|                                                    Years |                        $y$ |           1:20 |
|                                         Mean recruitment |                    $\mu_r$ |            30M |
|                    Standard deviation of log-recruitment |                 $\sigma_r$ |            0.5 |
|                                     Mean total mortality |                    $\mu_Z$ |            0.7 |
|                    Standard deviation of total mortality |                 $\sigma_Z$ |            0.2 |
|  Correlation across ages in error around total mortality |    $\varphi_{\delta, age}$ |            0.9 |
| Correlation across years in error around total mortality |   $\varphi_{\delta, year}$ |            0.5 |
|                                   Mean asymptotic length |               $l_{\infty}$ |         120 cm |
|                                          Length at birth |                      $l_0$ |           5 cm |
|                                              Growth rate |                        $K$ |            0.1 |
|                     Length group for abundance at length |            $l_{group}^{N}$ |           3 cm |
|                                                          |                            |                |  
|                                                   *Grid* |                            |                | 
|                                               Grid cells |                        $s$ |         1:6400 |
|                                               Resolution |                        $R$ |         3.5 km |
|                                              Shelf depth |                $d_{shelf}$ |          200 m |
|                                              Shelf width |                $w_{shelf}$ |         100 km |
|                                              Depth range |       $[d_{min}, d_{max}]$ |  [0 m, 1000 m] |
|                                      Number of divisions |                  $N_{div}$ |              1 |
|                                         Number of strata |                $N_{strat}$ |             42 |
|                                                          |                            |                |  
|                                           *Distribution* |                            |                | 
|        Standard deviation of age-year-space distribution |             $\sigma_{\xi}$ |            2.8 |
|                        Smoothness of spatial correlation |                  $\lambda$ |              1 |
|                             Range of spatial correlation |                        $r$ |          50 km |
|          Correlation across ages in spatial distribution |       $\varphi_{\xi, age}$ |           0.5* |
|         Correlation across years in spatial distribution |      $\varphi_{\xi, year}$ |            0.9 |
|            Depth at which abundance is typically highest |                    $\mu_d$ |          200 m |
|                Dispersion around depth of peak abundance |                 $\sigma_d$ |           70 m |
|                                                          |                            |                |  
|                                                 *Survey* |                            |                |
|                                  Area covered by a trawl |                $A_{trawl}$ |     0.03 km^2^ |
|              Steepness of logistic curve of catchability |                        $k$ |              2 |
|               Midpoint of logistic curve of catchability |                      $x_0$ |              3 |
|                            Length group for age sampling |                $l_{group}$ |           1 cm |  
\* Distribution set to be equal for ages 5+


<br>


Table: (\#tab:tests) - Descriptions and settings of different survey sampling protocol tested in the cod case study. All possible combinations of the options below were tested.

|      **Parameter name** |      **Symbol** |                                       **Setting** |
|:----------------------- | :-------------- | :------------------------------------------------ |
|             Set density |      $D_{sets}$ |    0.0005, 0.001, 0.002, 0.005, 0.01 sets / km^2^ |
|    Length sampling rule |   $M_{lengths}$ |       5, 10, 20, 50, 100, 500, 1000 lengths / set |
|       Age sampling rule |      $M_{ages}$ |   2, 5, 10, 20, 50 ages / length group / division |


<br>


Table: (\#tab:comp) - Root-mean-squared errors (RMSE) and number of samples [sets ($N_{sets}$), lengths ($N_{lengths}$) and ages ($N_{ages}$)] obtained from an array of surveys with different sampling protocol [set densities ($D_{sets}$), maximum sampling effort of lengths per set ($M_{lengths}$), and maximum number of ages to collect per length group ($M_{ages}$)]. Differences from the minimum RMSE value ($\Delta ~ RMSE$) within each set density option are presented to aid comparisons.

```{r comp, results = "asis"}

totals <- sim$samp_totals[, list(n_sets = mean(n_sets), n_caught = mean(n_caught),
                                 n_measured = mean(n_measured), n_aged = mean(n_aged)),
                          by = "survey"]
errors <- merge(sim$surveys, sim$age_strat_error_stats, by = "survey")
d <- merge(errors, totals, by = "survey")

which_set_dens <- c(0.0005, 0.002, 0.01)
which_len_caps <- c(10, 100, 1000)
which_age_caps <- c(5, 10, 50)

tab <- d[d$set_den %in% which_set_dens & d$lengths_cap %in% which_len_caps & 
           d$ages_cap %in% which_age_caps, 
         list(lengths_cap, ages_cap,
              n_sets = round(n_sets), n_measured = round(n_measured), n_aged = round(n_aged),
              RMSE = RMSE, delta_RMSE = RMSE - min(RMSE)), 
         by = "set_den"]
tab <- tab[order(set_den, delta_RMSE), ]
tab$set_den <- formatC(tab$set_den)
tab$set_den[tab$delta_RMSE != 0] <- NA
tab$RMSE <- si(tab$RMSE)
tab$delta_RMSE <- si(tab$delta_RMSE)

split_tab <- split(tab, tab$n_sets)
for (i in seq_along(split_tab)[-length(split_tab)]) {
  split_tab[[i]] <- rbind(split_tab[[i]], data.table(RMSE = NA), fill = TRUE)
}
tab <- rbindlist(split_tab)

names(tab) <- c("$D_{sets}$", "$M_{lengths}$", "$M_{ages}$", 
                "$N_{sets}$", "$N_{lengths}$", "$N_{ages}$",
                "$RMSE$", "$\\Delta ~ RMSE$")

options(knitr.kable.NA = "")
knitr::kable(tab, align = "r", format = "markdown")

```



# Figures

```{r sp, cache = TRUE, fig.height = 3.8, fig.width = 8.5, fig.cap = "- An example from year seven of the simulation of a) the distribution of total abundance available to the survey, and b) locations of the sets conducted and total numbers caught in a stratified random survey with a set density of 0.002 sets / km^2^. Grey lines indicate depth-based survey strata."}

which_year <- 7
which_sim <- 1

sp_N_tot <- sim$sp_I[year == which_year & sim == which_sim, list(N = sum(I)), by = c("year", "cell")]
xyz <- merge(sim$grid_xy, sp_N_tot, by = "cell")
size <- unique(diff(pretty(xyz$N, 25)))

sp_strat <- raster::rasterToPolygons(sim$grid$strat, dissolve = TRUE)
df_strat <- suppressWarnings(fortify(sp_strat) %>% group_by(group))

r <- raster::rasterFromXYZ(xyz[, c("x", "y", "N")])
l <- rasterToContour(r, levels = pretty(xyz$N, 20))
df_lines <- suppressWarnings(fortify(l))
levels <- as.numeric(as.character(l$level))
levels <- si(levels)
labs <- levels
labs[seq_along(labs) %% 2 == 0] <- ""
levels <- factor(levels, levels = levels)
names(levels) <- rownames(as.data.frame(l))
df_lines$level <- levels[df_lines$id]

abun_plot <- ggplot() +
  geom_path(data = df_strat, aes(x = long, y = lat, group = group), 
            color = "grey", size = 0.05) +
  geom_path(data = df_lines, aes(x = long, y = lat, group = group, color = level),
            size = 0.3) +
  scale_color_viridis(labels = labs, discrete = TRUE, name = "N") + 
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  coord_equal() +
  theme_void() + guides(color = guide_legend(keywidth = 0.4, keyheight = 0, 
                                             default.unit = "cm", ncol = 1)) +
  theme(legend.justification = c(0, 1),
        plot.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"))

setdet <- sim$setdet
setdet <- setdet[setdet$year == which_year & setdet$sim == which_sim, ]
breaks <- pretty(setdet$n, 7)

set_plot <- ggplot() +
  geom_path(data = df_strat, aes(x = long, y = lat, group = group), 
            color = "grey", size = 0.05) +
  geom_point(data = setdet, aes(x = x, y = y, size = n, color = n), alpha = 0.8) +
  scale_size_area(name = "   n", max_size = 10, limits = range(breaks), breaks = breaks) +
  scale_color_viridis(name = "   n", limits = range(breaks), breaks = breaks) + 
  scale_x_continuous(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  coord_equal() +
  theme_void() + guides(color = guide_legend(keywidth = 0.4, keyheight = 0.2, default.unit = "cm")) +
  theme(legend.justification = c(0, 1),
        plot.margin = unit(c(0.1, 0.1, 0.1, 0.1), "cm"))

p <- cowplot::plot_grid(abun_plot, set_plot, labels = c("a)", "b)"), align = "hv",
                   label_fontface = "plain")
cowplot::save_plot(plot = p, filename = "analysis/paper/figures/abun_and_sets_example.pdf",
                   base_height = 3.8, base_width = 8.5)
p

```

<br>

```{r tot, cache = TRUE, fig.width = 8, fig.height = 3, fig.cap = "- Fanchart of stratified estimates of the trend in total abundance from surveys with different set densities, $D_{sets}$. The heavy dark line indicates the true tred in the total population available to the survey."}

which_set_dens <- c(0.0005, 0.002, 0.01)
which_len_caps <- c(10, 100, 1000)

d <- merge(sim$surveys, sim$total_strat_error, by = "survey")
d <- d[d$set_den %in% which_set_dens & 
         d$lengths_cap == 100 & d$ages_cap == 10, ] ## length and age sampling not a factor here

p <- fan_plot(d, x = "Year", which_strat = "Total")
cowplot::save_plot(plot = p, filename = "analysis/paper/figures/total_strat_true_vs_est.pdf",
                   base_height = 3, base_width = 8)
p

```

<br>

```{r length, cache = TRUE, fig.width = 8, fig.height = 6, fig.cap = "- Fanchart of stratified estimates of abundance at length from year seven of the simulation from surveys with different set densities, $D_{sets}$, and length sampling protocol, $M_{lengths}$. The heavy dark line indicates the true population available to the survey."}

which_set_dens <- c(0.0005, 0.002, 0.01)
which_len_caps <- c(10, 100, 1000)
which_year <- 7

sub_surveys <- sim$surveys[sim$survey$set_den %in% which_set_dens &
                             sim$survey$lengths_cap %in% which_len_caps & 
                             sim$survey$ages_cap == 10, ]
sub_strat <- sim$length_strat_error[eval(sim$length_strat_error$survey %in% sub_surveys$survey &
                                           sim$length_strat_error$year == which_year), ]
d <- merge(sub_surveys, sub_strat, by = "survey")
d$length[d$length > 100] <- 100 # aggregate beyond 100 cm
d <- d[, list(I_hat = sum(I_hat), I = sum(I)), 
        by = c("year", "length", "sim", "survey", "set_den", "lengths_cap")]

p <- fan_plot(d, x = "Length", which_strat = "Length")
cowplot::save_plot(plot = p, filename = "analysis/paper/figures/true_vs_est_by_length.pdf",
                   base_height = 6, base_width = 8)
p

```


```{r age, cache = TRUE, fig.width = 8, fig.height = 6, fig.cap = "- Fanchart of stratified estimates of abundance at age from year seven of the simulation from surveys with different set densities, $D_{sets}$, and length sampling protocol, $M_{lengths}$. Number of ages sampled per length group, $M_{ages}$, was 10 in all scenarios. The heavy dark line indicates the true population available to the survey."}

which_set_dens <- c(0.0005, 0.002, 0.01)
which_len_caps <- c(10, 100, 1000)
which_year <- 7

sub_surveys <- sim$surveys[sim$survey$set_den %in% which_set_dens &
                             sim$survey$lengths_cap %in% which_len_caps & 
                             sim$survey$ages_cap == 10, ]
sub_strat <- sim$age_strat_error[eval(sim$age_strat_error$survey %in% sub_surveys$survey &
                                        sim$age_strat_error$year == which_year), ]
d <- merge(sub_surveys, sub_strat, by = "survey")
d <- d[d$year == which_year & d$set_den %in% which_set_dens &
         d$lengths_cap %in% which_len_caps & d$ages_cap == 10, ]
d$age[d$age > 10] <- 10 # aggregate beyond 10
d <- d[, list(I_hat = sum(I_hat), I = sum(I)), 
       by = c("year", "age", "sim", "survey", "set_den", "lengths_cap")]

p <- fan_plot(d, x = "Age")
cowplot::save_plot(plot = p, filename = "analysis/paper/figures/true_vs_est_by_age.pdf",
                   base_height = 6, base_width = 8)
p

```

<br>

```{r year, cache = TRUE, fig.width = 8, fig.height = 6, fig.cap = "- Fanchart of stratified estimates of the trend in abundance at age four from surveys with different set densities, $D_{sets}$, and length sampling protocol, $M_{lengths}$. Number of ages sampled per length group, $M_{ages}$, was 10 in all scenarios. The heavy dark line indicates the true trend in the population available to the survey."}

which_set_dens <- c(0.0005, 0.002, 0.01)
which_len_caps <- c(10, 100, 1000)
which_age <- 4

d <- merge(sim$surveys, sim$age_strat_error, by = "survey")
d <- d[d$age == which_age & d$set_den %in% which_set_dens &
       d$lengths_cap %in% which_len_caps & d$ages_cap == 10, ]

p <- fan_plot(d, x = "Year")
cowplot::save_plot(plot = p, filename = "analysis/paper/figures/true_vs_est_by_year.pdf",
                   base_height = 6, base_width = 8)
p

```

<br>

```{r error-lines, cache = TRUE, fig.height = 3.8, fig.width = 8.5, results = "hide", fig.cap = "- Root-mean-squared error (RMSE) of abundance at length and abundance at age estimates as a function of the number of fish measured ($N_{lengths}$) from an array of surveys with different sampling protocol. The labels represent surveys with different set densities ($D_{sets}$), where number of sets are shown in brackets, and the lines are color coded by length sampling protocol ($M_{lengths}$). Number of ages sampled per length group, $M_{ages}$, was 10 in all scenarios."}

totals <- sim$samp_totals[, list(n_sets = mean(n_sets), n_caught = mean(n_caught),
                                 n_measured = mean(n_measured), n_aged = mean(n_aged)),
                          by = "survey"]

errors <- merge(sim$surveys, sim$length_strat_error_stats, by = "survey")
length_d <- merge(errors, totals, by = "survey")
length_d <- length_d[length_d$ages_cap == 10, ]
length_d$strat <- "Abundance at length"

errors <- merge(sim$surveys, sim$age_strat_error_stats, by = "survey")
age_d <- merge(errors, totals, by = "survey")
age_d <- age_d[age_d$ages_cap == 10, ]
age_d$strat <- "Abundance at age"

d <- rbind(length_d, age_d)
d$cap <- factor(d$lengths_cap)
d$strat <- factor(d$strat, levels = c("Abundance at length", "Abundance at age"))

lab_d <- d[lengths_cap == max(lengths_cap),
           list(lengths_cap, n_measured, n_sets, cap, RMSE),
           by = c("set_den", "strat")]
lab_d$lab <- paste0(formatC(lab_d$set_den), " (", lab_d$n_sets, ")")

p <- ggplot(data = d, aes(x = n_measured, y = RMSE, group = set_den)) +
  geom_line(aes(color = cap), size = 2, lineend = "round") +
  geom_text(data = lab_d, aes(label = lab), nudge_x = 500, hjust = 0) +
  geom_point(data = lab_d, aes(color = cap)) +
  xlab(bquote(N[lengths])) +
  scale_y_continuous(labels = format_si()) +
  scale_x_continuous(labels = format_si(), limits = c(0, max(d$n_measured) * 1.3),
                     breaks = pretty(d$n_measured, 6)) +
  scale_color_viridis(name = bquote(M[lengths]), discrete = TRUE) +
  facet_wrap(~ strat, scales = "free", dir = "h") +
  theme_bw() +
  theme(legend.justification = c(0, 1),
        plot.margin = unit(c(0.2, 0.2, 0.2, 0.2), "cm"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        strip.background = element_blank(),
        panel.border = element_rect(fill = NA, color = "darkgrey", size = 0.4),
        axis.ticks = element_line(color = "darkgrey", size = 0.4))

cowplot::save_plot(plot = p, filename = "analysis/paper/figures/error_lines.pdf",
                   base_height = 3.8, base_width = 8.5)
p

```

<br>

```{r error-wireframe, cache = TRUE, fig.height = 3, fig.width = 8.5, results = "hide", fig.cap = "- Wireframe plot of root-mean-squared error (RMSE) from an array of surveys with different sampling protocol. Panels represent surveys with different set densities ($D_{sets}$), x-axes represent the maximum sampling effort of lengths per set ($M_{lengths}$), and y-axes represent the maximum number of ages to collect per length group ($M_{ages}$)."}

trellis_theme <- list(
  box.3d = list(col = "darkgrey"), 
  axis.line = list(col = "transparent"),
  strip.background = list(col = "transparent"), 
  strip.border = list(col = "transparent"),
   layout.heights = list(
        top.padding = 0,
        main.key.padding = 0,
        key.axis.padding = 0,
        axis.xlab.padding = 0,
        xlab.key.padding = 0,
        key.sub.padding = 0,
        bottom.padding = -5
    ),
    layout.widths = list(
        left.padding = 0,
        key.ylab.padding = 0,
        ylab.axis.padding = 0,
        axis.key.padding = 0,
        right.padding = 1
    )
)

zscale_format <- function(lim, logsc = FALSE, ...) {
    ans <- zscale.components.default(lim, logsc = logsc, ...)
    ans$left$labels$labels <- si(ans$left$labels$at)
    ans
}

d <- merge(sim$surveys, sim$age_strat_error_stats, by = "survey")
# d <- d[d$set_den != 0.0005, ]
d <- d[d$set_den %in% c(0.0005, 0.002, 0.01)]
set_den <- sort(unique(d$set_den))
d$set_den <- factor(d$set_den)
options(scipen = 999)
labs <- sapply(seq_along(set_den), function(i) as.expression(bquote(D[sets] == .(set_den[i]))), 
               USE.NAMES = FALSE)
zlabs <- list(at = pretty(d$RMSE), labels = si(pretty(d$RMSE)))

pdf("analysis/paper/figures/error_wireframe.pdf", height = 3, width = 8.5)

p <- wireframe(RMSE ~  lengths_cap * ages_cap | set_den, data = d,
          as.table = TRUE, drape = TRUE, col = "white", lwd = 0.5,
          strip = strip.custom(factor.levels = labs),
          scales = list(arrows = FALSE, cex = 0.7, z = zlabs),
          col.regions = viridis::viridis(100),
          screen = list(z = 230, x = 300), 
          xlab = list(expression(M[lengths]), rot = 25), 
          ylab = list(expression(M[ages]), rot = -15), 
          zlab = list("RMSE", rot = 95),
          colorkey = list(labels = zlabs, height = 0.6,
                          axis.line = list(col = "darkgrey")),
          par.settings = trellis_theme)
p <- update(p, layout = c(3, 1))
p
grid::grid.text("RMSE", x = unit(0.952, "npc"), y = unit(0.77, "npc"))

invisible(dev.off())

p
grid::grid.text("RMSE", x = unit(0.952, "npc"), y = unit(0.77, "npc"))

```

<br>



# Appendix 1: age-year-space covariance

The simulation applied in this paper was set-up to control covariance across ages, years and space. To do this we used a combination of Matérn covariance, to control the level of spatial aggregation, and the age-year covariance described in Cadigan [-@Cadigan2016], to control the level of similarity in distributions across ages and years. As described in Appendix A in Cadigan [-@Cadigan2016], the age-year covariance can be broken down into a series of AR(1) processes. We integrate Matérn covariance into this series of equations:

$$\xi_{a,y,s} \sim \left\{\begin{matrix} MVN\left (0, \frac{\sigma_\xi^2}{(1 - \varphi_{age}^2)(1 - \varphi_{year}^2)} \boldsymbol{R}_s \right ) & a = 1, y = 1 & \\  MVN\left (\varphi_{year} \xi_{1, y - 1, s}, \frac{\sigma_\xi^2}{(1 - \varphi_{age}^2)} \boldsymbol{R}_s \right ) & a = 1, y > 1 & \\ MVN\left (\varphi_{age} \xi_{a - 1, 1, s}, \frac{\sigma_\xi^2}{(1 - \varphi_{year}^2)} \boldsymbol{R}_s \right ) & a > 1, y = 1 & \\ MVN\left (\varphi_{year} \xi_{a, y - 1, s} + \varphi_{age} (\xi_{a - 1, y, s} - \varphi_{year} \xi_{a - 1, y - 1, s}), \sigma_\xi^2 \boldsymbol{R}_s \right ) & a > 1, y > 1 & \end{matrix}\right.$$

Where $MVN$ indicates the multivariate normal distribution, $\sigma_\xi^2$ controls the variance of the process, $\varphi_{\xi, age}$ and $\varphi_{\xi, year}$ control correlation in the age and year dimension and $\boldsymbol{R}_s$ is defined by Matérn correlation:

$$\boldsymbol{R}_s = \frac{2^{1-\lambda}}{\Gamma(\lambda)} (\kappa \left |s_i - s_j \right|) K_{\lambda}(\kappa \left |s_i - s_j \right|)$$
where $\left |s_i - s_j \right|$ is the Euclidean distance between two locations, $\Gamma$ is the gamma function, $K_{\lambda}$ denotes the modified Bessel function of the second kind, and $\lambda$ and $\kappa$ control the smoothness and scale of the spatial process [@Blangiardo2015]. With this structure, simulated error is correlated across ages, years and space.

<br>

# References




































